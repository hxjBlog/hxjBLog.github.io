<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/LOGO.png"><link rel="icon" href="/img/LOGO.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="hxj"><meta name="keywords" content=""><meta name="description" content="关于实验室遭受病毒攻击，讨论docker容器内逃逸问题"><meta property="og:type" content="article"><meta property="og:title" content="关于docker容器内逃逸"><meta property="og:url" content="https://hxjblog.github.io/2024/03/07/%E5%85%B3%E4%BA%8E%E5%AE%9E%E9%AA%8C%E5%AE%A4%E9%81%AD%E5%8F%97%E7%97%85%E6%AF%92%E6%94%BB%E5%87%BB%EF%BC%8C%E8%AE%A8%E8%AE%BAdocker%E5%AE%B9%E5%99%A8%E5%86%85%E9%80%83%E9%80%B8%E9%97%AE%E9%A2%98/index.html"><meta property="og:site_name" content="hello,hxjBLog"><meta property="og:description" content="关于实验室遭受病毒攻击，讨论docker容器内逃逸问题"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/webp/22498321/1710770415891-62dcb74f-1456-4b4f-8f51-2b0f7d94d67b.webp"><meta property="article:published_time" content="2024-03-06T16:00:00.000Z"><meta property="article:modified_time" content="2024-03-18T09:00:00.000Z"><meta property="article:author" content="hxj"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://cdn.nlark.com/yuque/0/2024/webp/22498321/1710770415891-62dcb74f-1456-4b4f-8f51-2b0f7d94d67b.webp"><meta name="referrer" content="no-referrer-when-downgrade"><title>关于docker容器内逃逸 - hello,hxjBLog</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var CONFIG={hostname:"hxjblog.github.io",root:"/",version:"1.9.7",typing:{enable:!0,typeSpeed:70,cursorChar:" ",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!1,baidu:null,google:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1},gtag:null},search_path:"/local-search.xml",include_content_in_search:!0};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 7.1.1"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>hxj</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/" target="_self"><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/" target="_self"><i class="iconfont icon-archive-fill"></i> <span>归档</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/" target="_self"><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/" target="_self"><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class="nav-item"><a class="nav-link" href="/about/" target="_self"><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/background.jpg) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="关于docker容器内逃逸"></span></div><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> hxj </span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2024-03-07 00:00" pubdate>2024年3月7日 凌晨</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 3k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 25 分钟 </span><span id="busuanzi_container_page_pv" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="busuanzi_value_page_pv"></span> 次</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 id="seo-header">关于docker容器内逃逸</h1><p id="updated-time" class="note note-info">本文最后更新于 2024年3月18日 下午</p><div class="markdown-body"><h1 id="事件概述"><a href="#事件概述" class="headerlink" title="事件概述"></a>事件概述</h1><p>最近，我们实验室的服务器遭到了校园网络中心的封禁。原因是服务器被发现感染了病毒，不仅被利用来挖掘加密货币，还攻击了其他在校园网内的服务器。让我们感到困惑的是，我们实验室的服务器架构相当严谨，由一个管理节点和三个GPU节点组成，管理平台更是基于docker的。我们在使用服务器进行运算时，其实是相当于开启了一个docker容器。在我的理解中，理论上，Docker的隔离特性应该能够防止病毒扩散到宿主机和其他容器。docker在设计上应该是一个隔离的环境，即使容器内部中了病毒，理论上也不应该能够影响到主节点或其他部分。我们只需简单地删除这个受感染的容器，问题就应该迎刃而解。<br>然而，实际情况却并非如此。我们尝试删除受感染的容器，但问题依然存在。这不禁让我们对Docker的安全性产生了疑问，也开始对背后的原因进行深入探索。</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22498321/1710770658470-e3433d10-8916-4283-9264-4dc39657243c.png" srcset="/img/loading.gif" lazyload referrerpolicy="no-referrer"></p><h1 id="Docker容器的安全误区"><a href="#Docker容器的安全误区" class="headerlink" title="Docker容器的安全误区"></a>Docker容器的安全误区</h1><p>Docker容器技术被广泛认为能够提供良好的隔离，帮助在隔离的环境中运行应用程序，从而增强安全性。通过查阅资料和实验，我们逐渐了解到，虽然Docker容器在设计上是一个隔离的环境，但并不意味着它完全安全。如果攻击者能够利用某些漏洞或者配置不当，完全有可能从容器内部逃逸到宿主机，进而影响到影响到宿主机或者网络中的其他机器。</p><h1 id="探索和发现"><a href="#探索和发现" class="headerlink" title="探索和发现"></a>探索和发现</h1><p>在深入研究之后，我们发现了几个关键的安全问题和漏洞，这些可能是导致服务器被攻击的原因：</p><ol><li><strong>容器逃逸</strong>：如果攻击者能够利用某些漏洞（比如旧版Docker中的漏洞），他们可能会逃离容器的限制，访问宿主机操作系统。</li><li><strong>网络配置不当</strong>：Docker容器的网络配置如果设置不当，可能会让攻击者通过容器攻击到网络中的其他服务器。</li><li><strong>宿主机的安全性</strong>：如果宿主机的安全更新不及时，或者存在配置错误，也可能成为攻击的跳板。</li></ol><h1><a href="#" class="headerlink"></a></h1><p>通过这次经历，我们学到了即使是在看似安全的容器化环境中，也存在着不容忽视的安全威胁。只有通过持续的学习、审计和改进，我们才能更好地保护我们的系统不受这些威胁的影响。<br>接下来，让我们通过一张插图来更直观地理解容器安全的重要性和实施的安全措施。</p><h1 id="Docker容器安全性探讨：从实验室服务器被攻击说起"><a href="#Docker容器安全性探讨：从实验室服务器被攻击说起" class="headerlink" title="Docker容器安全性探讨：从实验室服务器被攻击说起"></a>Docker容器安全性探讨：从实验室服务器被攻击说起</h1><p>近日，我们实验室使用的服务器被校园网络中心封禁。原因是服务器被发现感染了病毒，不仅被利用来挖掘加密货币，还攻击了其他在校园网内的服务器。<br>让我们感到困惑的是，我们实验室的服务器架构相当严谨，由一个管理节点和三个GPU节点组成，管理平台更是基于docker的。我们在使用服务器进行运算时，其实是相当于开启了一个docker容器。在我的理解中，理论上，Docker的隔离特性应该能够防止病毒扩散到宿主机和其他容器。docker在设计上应该是一个隔离的环境，即使容器内部中了病毒，理论上也不应该能够影响到主节点或其他部分。我们只需简单地删除这个受感染的容器，问题就应该迎刃而解。<br>然而，实际情况却并非如此。我们尝试删除受感染的容器，但问题依然存在。这不禁让我们对Docker的安全性产生了疑问，也开始对背后的原因进行深入探索。</p><h1 id="Docker容器技术简介"><a href="#Docker容器技术简介" class="headerlink" title="Docker容器技术简介"></a>Docker容器技术简介</h1><p>Docker容器技术以其高效、轻量的特点，成为了开发和运维中不可或缺的工具。它允许应用在隔离的环境中运行，提高了应用的可移植性和环境的一致性。然而，很多人误以为容器内的应用与主机系统完全隔离，但实际上，如果配置不当或存在漏洞，容器内的应用是有可能逃逸出来，影响宿主机或其他容器的。<br>容器逃逸和安全风险<br>容器逃逸（Container Escape）是指在容器化环境中，恶意程序或攻击者绕过容器的隔离机制，从而获得访问宿主机系统或其他容器的能力。这种攻击方式能够让攻击者从一个受限的容器环境中“逃脱”出来，对整个系统造成更广泛的影响。</p><h1 id="容器检测"><a href="#容器检测" class="headerlink" title="容器检测"></a>容器检测</h1><p>首先是容器内的病毒需要检测是否位于容器内，从而检测是否需要逃逸。容器内的病毒或恶意软件判断是否需要逃逸，通常涉及到对其运行环境的分析和一系列的条件检测。其目的是评估逃逸的可能性、价值和风险，以确定进行逃逸攻击的最佳时机。以下是病毒可能采取的步骤和逻辑：</p><ol><li><p>环境侦察</p><ul><li><strong>操作系统和版本检测</strong>：病毒首先会检测宿主机的操作系统类型和版本，以确定是否存在已知的适用漏洞。</li><li><strong>容器管理工具识别</strong>：识别容器运行时环境（如Docker、Kubernetes等），了解其版本和配置，判断是否存在可利用的管理工具漏洞。</li><li><strong>权限级别评估</strong>：检查当前容器的权限级别，包括是否有root权限或其他高级权限，这将直接影响逃逸的难易度。</li></ul></li><li><p>漏洞和配置错误探测</p><ul><li><strong>搜索已知漏洞</strong>：病毒会搜索宿主机操作系统或容器运行时环境的已知漏洞，特别是那些可以用于提升权限或执行远程代码的漏洞。</li><li><strong>审计容器配置</strong>：检查是否存在错误配置，如不安全的挂载点、过度开放的网络配置或不必要的Linux功能（Capabilities）。</li></ul></li><li><p>监控和信号</p><ul><li><strong>监听环境变化</strong>：病毒可能会在背景静默监控，等待特定的环境变化或触发条件，如系统更新、配置变更或与外部控制服务器的通信。</li><li><strong>评估攻击价值</strong>：基于对环境的分析，病毒会评估逃逸的潜在价值，比如是否能够访问更多敏感数据或资源、是否有利于持久化控制等。</li></ul></li><li><p>风险评估</p><ul><li><strong>检测防御机制</strong>：病毒会探测宿主机和容器环境中的安全防御工具和机制，如SELinux、AppArmor或防病毒软件，评估逃逸行为可能触发的安全响应。</li><li><strong>计算被发现风险</strong>：评估执行逃逸操作被系统监控工具发现的风险，以及可能因此面临的对抗措施。</li></ul></li></ol><h1 id="实施决策"><a href="#实施决策" class="headerlink" title="实施决策"></a>实施决策</h1><p>基于上述评估，病毒将决定是否进行逃逸尝试。如果环境条件有利且逃逸的收益高于风险，病毒可能会选择执行逃逸。相反，如果逃逸风险高或环境条件不满足，病毒可能会选择继续在当前容器内活动，或者寻找其他方式影响系统。</p><h1 id="病毒逃逸"><a href="#病毒逃逸" class="headerlink" title="病毒逃逸"></a>病毒逃逸</h1><p>而当决定进行逃逸后，下面是一些常见的容器逃逸方法的详细介绍：</p><ol><li><p>滥用容器权限</p><ul><li><strong>利用高权限容器</strong>：如果容器以高权限（如root）运行，攻击者可能利用这些权限执行系统命令或安装恶意软件，进而实现逃逸。</li><li><strong>未限制的Linux功能</strong>（Capabilities）：Linux内核提供了一套功能位（Capabilities）来对进程的权限进行细粒度控制。如果容器配置允许过多的功能位，攻击者可能利用这些额外权限进行逃逸。</li></ul></li><li><p>容器运行时漏洞利用</p><ul><li><strong>Docker和容器管理工具漏洞</strong>：像Docker这样的容器管理工具如果存在安全漏洞，攻击者可以通过这些漏洞获得宿主机的控制权。例如，历史上曾发现过Docker Daemon的远程代码执行漏洞。</li><li><strong>内核漏洞</strong>：容器与宿主机共享相同的内核。如果内核存在漏洞，攻击者可能通过容器来利用这些漏洞，从而影响到宿主机系统。</li></ul></li><li><p>错误配置导致的逃逸</p><ul><li><strong>挂载敏感目录</strong>：如果容器错误地挂载了宿主机的敏感目录（如<code>/proc</code>、<code>/sys</code>），攻击者可以通过这些挂载点访问宿主机的敏感信息或修改系统配置。</li><li><strong>网络配置不当</strong>：错误的网络配置可能允许容器访问宿主机的网络接口或其他不应访问的网络资源。</li></ul></li><li><p>逃逸工具和技术</p><ul><li><strong>特殊工具和脚本</strong>：存在一些专为容器逃逸设计的工具和脚本，如<code>Shocker</code>等，它们可以自动化检测和利用环境漏洞来实现逃逸。</li><li><strong>Namespace切换</strong>：Linux的Namespace是实现容器隔离的关键技术。攻击者可能尝试切换或逃离当前Namespace，以获取对其他Namespace或宿主机的访问。</li></ul></li></ol><h1 id="防御措施"><a href="#防御措施" class="headerlink" title="防御措施"></a>防御措施</h1><ul><li><strong>最小权限原则</strong>：确保容器运行所需的最小权限，避免使用root权限运行容器。</li><li><strong>及时更新和打补丁</strong>：定期更新容器运行时环境和宿主机的操作系统，修复已知漏洞。</li><li><strong>安全配置和审计</strong>：仔细检查容器配置，避免敏感挂载，并使用工具进行安全审计。</li><li><strong>使用安全加固的容器基础镜像</strong>：使用已经过安全加固的容器基础镜像，减少容器内部的潜在攻击面。</li><li><strong>利用安全工具</strong>：使用如SELinux、AppArmor等安全模块增加额外的安全控制层面。<br>:::info<br>值得注意的是，这个过程可能高度自动化，且随着恶意软件技术的发展，病毒的检测和决策能力也在不断进步，容器逃逸技术的演变非常快。因此，维护容器和宿主机的安全，需要持续关注最新的安全威胁和防御技术。<br>:::</li></ul><h1 id="本次病毒操作的技术分析"><a href="#本次病毒操作的技术分析" class="headerlink" title="本次病毒操作的技术分析"></a>本次病毒操作的技术分析</h1><p>病毒通常利用容器内的高权限（例如root权限），通过特定的技术手段实现逃逸，进而对外部宿主机和其他容器进行攻击。这次事件中，病毒正是利用了我们平台对每个Docker容器分配的高权限进行逃逸和攻击。<br>我们的服务器是由一个管理节点和3个GPU节点组成，运行基于Docker的管理平台。本以为容器之间相互隔离，即使容器内有病毒，删除容器就能解决问题。然而，实际情况并非如此简单，这次事件暴露了我们在容器安全管理上的漏洞和配置不当。<br>结论<br>Docker容器虽然为我们的开发和运维带来了便利，但也给安全管理带来了挑战。只有通过持续的学习、审计和实践，我们才能确保容器技术的安全使用。<br><img src="https://cdn.nlark.com/yuque/0/2024/webp/22498321/1710770415891-62dcb74f-1456-4b4f-8f51-2b0f7d94d67b.webp" srcset="/img/loading.gif" lazyload referrerpolicy="no-referrer" alt="容器攻击.webp"></p></div><hr><div><div class="post-metas my-3"></div><div class="license-box my-3"><div class="license-title"><div>关于docker容器内逃逸</div><div>https://hxjblog.github.io/2024/03/07/关于实验室遭受病毒攻击，讨论docker容器内逃逸问题/</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>hxj</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2024年3月7日</div></div><div class="license-meta-item"><div>许可协议</div><div><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"></article><article class="post-next col-6"><a href="/2023/12/27/%E5%9C%A8Docker%E7%8E%AF%E5%A2%83%E4%B8%AD%E4%BD%BF%E7%94%A8.env%E5%92%8Cdocker-compose%E6%96%87%E4%BB%B6%E8%BF%9B%E8%A1%8C%E8%B7%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%80%9A%E4%BF%A1/" title="Docker和docker-compose"><span class="hidden-mobile">Docker和docker-compose</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>目录</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div><div class="statistics"><span id="busuanzi_container_site_pv" style="display:none">总访问量 <span id="busuanzi_value_site_pv"></span> 次 </span><span id="busuanzi_container_site_uv" style="display:none">总访客数 <span id="busuanzi_value_site_uv"></span> 人</span></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t,e){var i=Fluid.plugins.typing,n=e.getElementById("subtitle");n&&i&&i(n.getAttribute("data-typed-text"))}(window,document)</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js",(function(){var t=jQuery("#toc");if(0!==t.length&&window.tocbot){var i=jQuery("#board-ctn").offset().top;window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-i},CONFIG.toc)),t.find(".toc-list-item").length>0&&t.css("visibility","visible"),Fluid.events.registerRefreshCallback((function(){if("tocbot"in window){tocbot.refresh();var t=jQuery("#toc");if(0===t.length||!tocbot)return;t.find(".toc-list-item").length>0&&t.css("visibility","visible")}}))}}))</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",(function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback((function(){if("anchors"in window){anchors.removeAll();var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}}))}))</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",(function(){Fluid.plugins.fancyBox()}))</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/snowflake.min.js"></script><script src="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/Cherry.min.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>